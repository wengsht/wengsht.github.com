<html>
    <head>
        <script type="text/javascript" src="../../wiki_js/jquery-ui-1.8.18.custom.js"></script>
        <link media="all" rel="stylesheet" href="../../wiki_styles/wiki.css" type="text/css" />
        <link media="all" rel="stylesheet" href="../../wiki_styles/syntaxhighlighter/styles/shCoreEmacs.css" type="text/css" />
        <link media="all" rel="stylesheet" href="../../wiki_styles/syntaxhighlighter/styles/shThemeEmacs.css" type="text/css" />

        <script type="text/javascript" src="../../wiki_styles/syntaxhighlighter/scripts/shCore.js"></script> 
        <script type="text/javascript" src="../../wiki_styles/syntaxhighlighter/scripts/shBrushPython.js"></script>
        <script type="text/javascript" src="../../wiki_styles/syntaxhighlighter/scripts/shBrushBash.js"></script>
        <script type="text/javascript" src="../../wiki_styles/syntaxhighlighter/scripts/shBrushCpp.js"></script>
        <script type="text/javascript" src="../../wiki_styles/syntaxhighlighter/scripts/shBrushPowerShell.js"></script>
        <script type="text/javascript" src="../../wiki_js/wiki_js.js"></script>
       
        <script type="text/javascript" src="../../wiki_styles/syntaxhighlighter/scripts/shBrushXml.js"></script>
        <script type="text/javascript">
            SyntaxHighlighter.config.clipboardSwf = "../../scripts/clipboard.swf";
            SyntaxHighlighter.all();
        </script> 
        <title>awk</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    </head>
    <div id="header">
	<ul id="top-nav">
		<li>
			<a href="../../index.html">首页</a>
		</li>
		<li>
			<a href="../../wiki.html">知识管理</a>
		</li>
		<li>
			<a href="../../diary/diary.html">日记</a>
		</li>
	</ul>
</div>
    <center style="font-family: 华文行楷; font-size: x-large; font-weight: normal; color: #FF6600">沙漏不倒翁 - 小屋</center><br />

    <body>
        <div class="content">
        
<h1 id="toc_1">awk</h1>
<h2 id="toc_1.1">基本语法</h2>
<pre>
BEGIN {}
pattern1 {}
pattern2 {}
END {} 
</pre>

<p>
pattern 的选择，正则表达式
</p>

<h2 id="toc_1.2">实用变量</h2>
<p>
可以在BEING或者<code>-v</code>后面修改这些值
<table>
<tr>
<td>
NF
</td>
<td>
本行字段数目
</td>
</tr>
<tr>
<td>
OFS
</td>
<td>
输出分隔符
</td>
</tr>
<tr>
<td>
FS
</td>
<td>
输入分隔符，可用 <code>-F:</code> 指定为冒号
</td>
</tr>
<tr>
<td>
FILENAME
</td>
<td>
当前输入文件的名称
</td>
</tr>
<tr>
<td>
NR
</td>
<td>
记录数(行数)
</td>
</tr>
<tr>
<td>
ORS
</td>
<td>
输出记录的分隔符(默认换行)
</td>
</tr>
<tr>
<td>
RS
</td>
<td>
输入记录的分隔符(默认换行)
</td>
</tr>
<tr>
<td>
FNR
</td>
<td>
当前记录序号
</td>
</tr>
</table>
</p>

<p>
可以用正则表达式赋值，如 <code>RS=:+</code> 表示行分隔符是1个或多个<code>:</code>
</p>

<h2 id="toc_1.3">选项</h2>

<table>
<tr>
<td>
-F
</td>
<td>
<code>-F:</code> 指定分隔符为冒号
</td>
</tr>
<tr>
<td>
-v
</td>
<td>
<code>-v FS=":"</code>
</td>
</tr>
</table>

<h2 id="toc_1.4">命令行参数</h2>
<p>
存在<code>ARGV</code> 数组中, 键值是数字
</p>

<h2 id="toc_1.5">环境变量</h2>
<p>
存在<code>ENVIRON</code>数组中，键值是变量名字符串，如 <code>ENVIRON["HOME"]</code>
</p>


<h2 id="toc_1.6">分支</h2>
<pre>
if (?)
  ?
else if (?)
  ?
else
  ?
</pre>

<h2 id="toc_1.7">循环</h2>
<pre>
while ()
  ?
  
for (;;)
  ?
  
array["map"] = 2
array[1] = 3
for (a in array)
  print a, array[a]
# map 2
# 1 3
 
if("map" in array)
    print "map is in array"
    
</pre>

<h2 id="toc_1.8">流程控制</h2>
<table>
<tr>
<td>
break
</td>
<td>
&nbsp;
</td>
</tr>
<tr>
<td>
continue
</td>
<td>
&nbsp;
</td>
</tr>
<tr>
<td>
next
</td>
<td>
下一条记录
</td>
</tr>
<tr>
<td>
nextfile
</td>
<td>
&nbsp;
</td>
</tr>
<tr>
<td>
exit exitcode
</td>
<td>
&nbsp;
</td>
</tr>
</table>

<h2 id="toc_1.9">输入</h2>
<table>
<tr>
<td>
getline
</td>
<td>
从当前输入文件中读取下一条记录存入<code>$0</code>并更新<code>NF</code>, <code>NR</code>, <code>FNR</code>
</td>
<td>
&nbsp;
</td>
</tr>
<tr>
<td>
getline var
</td>
<td>
存入var并更新 <code>NR</code>, <code>FNR</code>
</td>
<td>
&nbsp;
</td>
</tr>
<tr>
<td>
getline &lt; file
</td>
<td>
重定向
</td>
<td>
&nbsp;
</td>
</tr>
<tr>
<td>
`cmd
</td>
<td>
getline`
</td>
<td>
管道
</td>
</tr>
</table>

<p>
管道例子：
<code>"ls" | getline ; print $0</code>
</p>

<h2 id="toc_1.10">重定向</h2>
<p>
<code>awk '{print $0 &gt; "1.txt" }' b.cpp</code>
</p>

<h2 id="toc_1.11">执行外部程序</h2>
<p>
管道和输出重定向可以实现，也可以用<code>system</code>
</p>

<p>
<code>system("ls")</code>
</p>

<h2 id="toc_1.12">函数</h2>
<pre>
function f(a, b)
{
return a+b
    
}
f(1, 2)


</pre>

        </div>
    </body>
    <center style="margin-top: 0px"><p style="padding-left: 100px;"> 主题来自 <a href="http://www.ruchee.com/">Ruchee</a> </p> </center>
</html>
